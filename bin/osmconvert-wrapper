#!/bin/sh
# Copyright (c) 2015 Wolfram Schneider, https://bbbike.org
#
# a wrapper to sent osmconvert output to a file
#
# usage: ./osmconvert_wrapper -o outfile.pbf [ osmconvert parameters ]

set -e
: ${osmconvert_program="osmconvert"}
PATH=/usr/local/bin:/bin:/usr/bin

tmpfile=""
case $1 in
  -o | --o ) out=$2
             tmpfile=$(mktemp $out.XXXXXXXX.tmp)
	     exec > $tmpfile
	     shift; shift
	     ;;
  *  ) ;;
esac

$osmconvert_program $@

# create real output file on success
mv -f $tmpfile $out

